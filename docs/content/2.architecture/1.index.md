---
title: Overview
description: Understanding the CapyDeploy system architecture
icon: ph:git-branch-duotone
---

# Architecture Overview

CapyDeploy uses a **Hub-Agent** architecture with **WebSocket** as the primary communication channel.

## Components

::card-grid
  ::card{icon=ph:desktop-duotone}
  #title
  Hub
  #description
  Your PC. Discovers Agents via mDNS, opens WebSocket connections, orchestrates uploads, stores auth tokens.
  ::

  ::card{icon=ph:device-mobile-duotone}
  #title
  Agent
  #description
  Target device. WebSocket server on port 9999. Receives binary chunks, creates Steam shortcuts, applies artwork.
  ::

  ::card{icon=ph:package-duotone}
  #title
  Shared Packages
  #description
  Common code in `pkg/` - protocol definitions, mDNS discovery, Steam utilities, file transfer.
  ::
::

## Communication

::alert{type="warning"}
**WebSocket is the primary protocol.** HTTP endpoints exist but are deprecated and for backwards compatibility only.
::

| Channel | Purpose |
|---------|---------|
| **WebSocket** | All communication: handshake, pairing, RPC, uploads, events |
| **mDNS** | Discovery: Agent broadcasts `_capydeploy._tcp` on port 9999 |
| **HTTP** | Deprecated: Legacy endpoints still registered but not recommended |

## Technology Stack

### Backend (Go)

::list{type="info"}
- **Go 1.24** - Core language
- **Wails v2** - Desktop app framework
- **Gorilla WebSocket** - WebSocket communication
- **Zeroconf** - mDNS discovery
::

### Frontend (Svelte)

::list{type="info"}
- **Svelte 5** - UI framework
- **SvelteKit** - Meta-framework
- **Tailwind CSS v4** - Styling
- **shadcn-svelte** - Components
::

## Data Flow

::steps
### Discovery
Agent registers mDNS service. Hub discovers via Zeroconf client.

### WebSocket Connection
Hub connects to `ws://[agent]:9999/ws`. Persistent bidirectional channel.

### Authentication
First time: 6-digit code pairing. Token stored. Future: token validation.

### Operations
All via WebSocket messages: get_info, list_shortcuts, create_shortcut, etc.

### Uploads
Binary chunks over WebSocket. Progress events pushed in real-time.
::

## Key Modules

| Module | Location | Purpose |
|--------|----------|---------|
| Protocol | `pkg/protocol/` | Message types, capabilities, payloads |
| Discovery | `pkg/discovery/` | mDNS client (Hub) and server (Agent) |
| Transfer | `pkg/transfer/` | Chunk writing, progress tracking |
| Steam | `pkg/steam/` | Paths, users, shortcut utilities |
| WS Server | `apps/agent/server/wsserver.go` | WebSocket server, message routing |
| WS Client | `apps/hub/wsclient/client.go` | WebSocket client, binary uploads |
| Auth | `apps/agent/auth/` | Pairing codes, token validation |

## Learn More

::card-grid
  ::card{icon=ph:plugs-connected-duotone}
  #title
  [Hub-Agent Pattern](/architecture/hub-agent)
  #description
  WebSocket protocol details, message types, binary uploads.
  ::

  ::card{icon=ph:star-duotone}
  #title
  [Capabilities](/architecture/capabilities)
  #description
  How Agents report features dynamically.
  ::
::
